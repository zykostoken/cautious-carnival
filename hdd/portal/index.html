<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hospital de D√≠a - Cl√≠nica Jos√© Ingenieros</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" href="/css/hdd-portal.css">
</head>
<body>
  <!-- Login View -->
  <div id="login-view" class="login-container">
    <div class="login-card">
      <div class="login-header">
        <div class="logo-icon" style="width: 60px; height: 60px; font-size: 1.75rem; margin: 0 auto 1rem;">HdD</div>
        <h1>Hospital de D√≠a</h1>
        <p>Cl√≠nica Psiqui√°trica Jos√© Ingenieros</p>
      </div>

      <!-- Login Form -->
      <form id="login-form">
        <div class="form-group">
          <label for="dni">DNI</label>
          <input type="text" id="dni" name="dni" placeholder="Ingrese su DNI" required>
        </div>

        <div class="form-group">
          <label for="password">Contrase√±a</label>
          <input type="password" id="password" name="password" placeholder="Ingrese su contrase√±a" required>
          <p class="form-hint">Si es su primer inicio de sesi√≥n, esta ser√° su nueva contrase√±a.</p>
        </div>

        <div id="login-error" class="form-error hidden"></div>

        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem; padding: 0.75rem;">
          Iniciar Sesi√≥n
        </button>
      </form>

      <div style="margin-top: 1.5rem; text-align: center; border-top: 1px solid var(--border); padding-top: 1.5rem;">
        <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem;">¬øPrimera vez aqu√≠?</p>
        <button type="button" class="btn btn-secondary" style="width: 100%;" onclick="showRegisterForm()">
          Registrarse
        </button>
      </div>

      <div style="margin-top: 1.5rem; text-align: center;">
        <a href="/hdd" class="back-link">‚Üê Volver a Hospital de D√≠a</a>
      </div>
    </div>
  </div>

  <!-- Register View -->
  <div id="register-view" class="login-container hidden">
    <div class="login-card">
      <div class="login-header">
        <div class="logo-icon" style="width: 60px; height: 60px; font-size: 1.75rem; margin: 0 auto 1rem;">HdD</div>
        <h1>Registrarse</h1>
        <p>Hospital de D√≠a</p>
      </div>

      <div class="alert alert-info" style="background: #e0f2fe; color: #0369a1; margin-bottom: 1rem;">
        Solo pueden registrarse pacientes autorizados por la cl√≠nica.
      </div>

      <form id="register-form">
        <div class="form-group">
          <label for="reg-dni">DNI *</label>
          <input type="text" id="reg-dni" placeholder="Ej: 12345678" required>
          <p class="form-hint">Ingres√° tu DNI sin puntos</p>
        </div>

        <div class="form-group">
          <label for="reg-fullname">Nombre Completo *</label>
          <input type="text" id="reg-fullname" placeholder="Nombre y apellido" required>
        </div>

        <div class="form-group">
          <label for="reg-email">Email *</label>
          <input type="email" id="reg-email" placeholder="tu@email.com" required>
        </div>

        <div class="form-group">
          <label for="reg-password">Contrase√±a *</label>
          <input type="password" id="reg-password" placeholder="M√≠nimo 6 caracteres" required>
        </div>

        <div id="register-error" class="form-error hidden"></div>

        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem; padding: 0.75rem;">
          Registrarse
        </button>
      </form>

      <div style="margin-top: 1.5rem; text-align: center;">
        <button type="button" class="btn btn-secondary" style="width: 100%;" onclick="showLoginForm()">
          ‚Üê Ya tengo cuenta
        </button>
      </div>
    </div>
  </div>

  <!-- Main App View -->
  <div id="app-view" class="hidden">
    <header class="header">
      <div class="header-content">
        <a href="/hdd/portal" class="logo">
          <div class="logo-icon">HdD</div>
          <div>
            <div class="logo-text">Hospital de D√≠a</div>
            <div class="logo-subtitle">Comunidad</div>
          </div>
        </a>

        <div class="user-menu">
          <span class="user-name" id="user-name"></span>
          <button class="btn btn-secondary" onclick="showProfileModal()">Perfil</button>
          <button class="btn btn-secondary" onclick="logout()">Salir</button>
        </div>
      </div>
    </header>

    <main class="container">
      <div class="nav-tabs">
        <button class="nav-tab active" data-tab="feed" onclick="switchTab('feed')">Comunidad</button>
        <button class="nav-tab" data-tab="games" onclick="switchTab('games')">Juegos</button>
        <button class="nav-tab" data-tab="activities" onclick="switchTab('activities')">Actividades</button>
        <button class="nav-tab" data-tab="salas" onclick="switchTab('salas')">üìπ Salas de Video</button>
        <button class="nav-tab" data-tab="my-posts" onclick="switchTab('my-posts')">Mis Publicaciones</button>
        <button class="nav-tab" data-tab="metrics" onclick="switchTab('metrics')">üìä M√©tricas</button>
      </div>

      <!-- Feed Tab -->
      <div id="tab-feed" class="feed-container">
        <div class="create-post">
          <textarea id="new-post-content" placeholder="¬øQu√© quieres compartir hoy?"></textarea>
          <div class="create-post-actions">
            <div class="post-options">
              <button class="post-option" onclick="document.getElementById('image-upload').click()" title="Agregar imagen">
                üì∑
              </button>
              <input type="file" id="image-upload" accept="image/*" style="display: none;" onchange="handleImageUpload(this)">
            </div>
            <button class="btn btn-primary" onclick="createPost()">Publicar</button>
          </div>
          <div id="image-preview" class="hidden" style="margin-top: 0.5rem;">
            <img id="preview-img" style="max-height: 150px; border-radius: 8px;">
            <button class="btn btn-secondary" onclick="clearImagePreview()" style="margin-left: 0.5rem;">‚úï</button>
          </div>
        </div>

        <div id="feed-posts">
          <div class="loading">Cargando publicaciones...</div>
        </div>
      </div>

      <!-- Games Tab -->
      <div id="tab-games" class="feed-container hidden">
        <h2 style="margin-bottom: 1rem;">Juegos Terap√©uticos</h2>
        <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Ejercicios l√∫dicos para trabajar habilidades cognitivas y motoras.</p>

        <div style="display: grid; gap: 1rem; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
          <!-- Game 1: Lawn Mower -->
          <div class="activity-card" style="cursor: pointer;" onclick="openGame('lawn-mower')">
            <div class="activity-icon" style="font-size: 2rem;">üåø</div>
            <div class="activity-info">
              <div class="activity-name">Cortadora de C√©sped</div>
              <div class="activity-schedule">Motricidad fina, planificaci√≥n, atenci√≥n</div>
            </div>
            <span style="color: var(--primary);">Jugar ‚Üí</span>
          </div>

          <!-- Game 2: Memory Prescriptions -->
          <div class="activity-card" style="cursor: pointer;" onclick="window.open('/hdd/portal/games/medication-memory.html?demo=true', '_blank')">
            <div class="activity-icon" style="font-size: 2rem;">üíä</div>
            <div class="activity-info">
              <div class="activity-name">Memoria de Medicamentos</div>
              <div class="activity-schedule">Memoria, atenci√≥n, seguimiento de instrucciones</div>
            </div>
            <span style="color: var(--primary);">Jugar ‚Üí</span>
          </div>

          <!-- Game 3: Pill Organizer -->
          <div class="activity-card" style="cursor: pointer;" onclick="window.open('/games/play/pill-organizer.html?demo=true', '_blank')">
            <div class="activity-icon" style="font-size: 2rem;">üíä</div>
            <div class="activity-info">
              <div class="activity-name">Organizador de Medicaci√≥n</div>
              <div class="activity-schedule">Motricidad fina, organizaci√≥n cognitiva</div>
            </div>
            <span style="color: var(--primary);">Jugar ‚Üí</span>
          </div>

          <!-- Game 4: Neuro-Chef -->
          <div class="activity-card" style="cursor: pointer;" onclick="window.open('/games/play/neuro-chef/index.html?demo=true', '_blank')">
            <div class="activity-icon" style="font-size: 2rem;">üçΩÔ∏è</div>
            <div class="activity-info">
              <div class="activity-name">Neuro-Chef: La Mesa Puesta</div>
              <div class="activity-schedule">Planificaci√≥n motora, memoria procedimental</div>
            </div>
            <span style="color: var(--primary);">Jugar ‚Üí</span>
          </div>
        </div>

        <!-- Game Container (for inline games if needed) -->
        <div id="game-container" class="hidden" style="margin-top: 2rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3 id="game-title"></h3>
            <button class="btn btn-secondary" onclick="closeGame()">Cerrar juego</button>
          </div>
          <div id="game-area" style="background: var(--surface); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;"></div>
        </div>

      </div>
    </div>

    <!-- Activities Tab -->
      <div id="tab-activities" class="feed-container hidden">
        <h2 style="margin-bottom: 1rem;">Actividades Semanales</h2>
        <div id="activities-list">
          <div class="loading">Cargando actividades...</div>
        </div>

        <div style="margin-top: 2rem;">
          <h3 style="margin-bottom: 1rem;">Galeria de Productos</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem;">
            <img src="/hdd/img/kits-verduras.jpg" alt="Kits de Verduras" style="width: 100%; border-radius: 8px;">
            <img src="/hdd/img/flores-papel.jpg" alt="Flores de Papel" style="width: 100%; border-radius: 8px;">
            <img src="/hdd/img/masa-tortas.jpg" alt="Masa para Tortas" style="width: 100%; border-radius: 8px;">
            <img src="/hdd/img/ensalada-frutas.jpg" alt="Ensalada de Frutas" style="width: 100%; border-radius: 8px;">
          </div>
        </div>

        <!-- Resources Section -->
        <div style="margin-top: 2rem;">
          <h3 style="margin-bottom: 1rem;">Recursos y Material de Apoyo</h3>
          <div id="portal-resources-list">
            <div class="loading">Cargando recursos...</div>
          </div>
        </div>
      </div>

      <!-- My Posts Tab -->
      <div id="tab-my-posts" class="feed-container hidden">
        <h2 style="margin-bottom: 1rem;">Mis Publicaciones</h2>
        <div id="my-posts-list">
          <div class="loading">Cargando...</div>
        </div>
      </div>
    
      <!-- Metrics Tab -->
      <div id="tab-metrics" class="hidden">
        <iframe src="/hdd/portal/metrics.html" style="width: 100%; height: 800px; border: none; border-radius: 12px;"></iframe>
      </div>

      <!-- Salas de Video Tab -->
      <div id="tab-salas" class="feed-container hidden">
        <h2 style="margin-bottom: 1rem;">üìπ Salas de Videollamada Grupal</h2>
        <p style="color: var(--text-muted); margin-bottom: 2rem;">Accede a las salas de videollamada para sesiones grupales, talleres y actividades terap√©uticas.</p>

        <div style="display: grid; gap: 1.5rem; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
          
          <!-- Sala 1: Consulta Grupal -->
          <div style="background: var(--surface); border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem; transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">üë•</div>
            <h3 style="margin-bottom: 0.5rem; text-align: center;">Consulta Grupal</h3>
            <p style="color: var(--text-muted); text-align: center; font-size: 0.9rem; margin-bottom: 1rem;">Sala principal para consultas grupales con pacientes del HDD.</p>
            <p style="text-align: center; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1.5rem;">Capacidad: 20 participantes</p>
            <button class="btn btn-primary" style="width: 100%;" onclick="window.open('/hdd/admin/salas/consulta-grupal', '_blank')">Unirse a la Sala</button>
          </div>

          <!-- Sala 2: Aula Virtual -->
          <div style="background: var(--surface); border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem; transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">üéì</div>
            <h3 style="margin-bottom: 0.5rem; text-align: center;">Aula Virtual</h3>
            <p style="color: var(--text-muted); text-align: center; font-size: 0.9rem; margin-bottom: 1rem;">Sala para clases, talleres educativos y presentaciones.</p>
            <p style="text-align: center; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1.5rem;">Capacidad: 30 participantes</p>
            <button class="btn btn-primary" style="width: 100%;" onclick="window.open('/hdd/admin/salas/aula-virtual', '_blank')">Unirse a la Sala</button>
          </div>

          <!-- Sala 3: Terapia Grupal -->
          <div style="background: var(--surface); border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem; transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">üßò</div>
            <h3 style="margin-bottom: 0.5rem; text-align: center;">Terapia Grupal</h3>
            <p style="color: var(--text-muted); text-align: center; font-size: 0.9rem; margin-bottom: 1rem;">Sala para sesiones de terapia grupal y mindfulness.</p>
            <p style="text-align: center; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1.5rem;">Capacidad: 15 participantes</p>
            <button class="btn btn-primary" style="width: 100%;" onclick="window.open('/hdd/admin/salas/terapia-grupal', '_blank')">Unirse a la Sala</button>
          </div>

          <!-- Sala 4: Sala Multimedia -->
          <div style="background: var(--surface); border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem; transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">üé¨</div>
            <h3 style="margin-bottom: 0.5rem; text-align: center;">Sala Multimedia</h3>
            <p style="color: var(--text-muted); text-align: center; font-size: 0.9rem; margin-bottom: 1rem;">Para compartir videos, pel√≠culas y contenido multimedia.</p>
            <p style="text-align: center; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1.5rem;">Capacidad: 25 participantes</p>
            <button class="btn btn-primary" style="width: 100%;" onclick="window.open('/hdd/admin/salas/sala-multimedia', '_blank')">Unirse a la Sala</button>
          </div>

        </div>

        <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 12px; padding: 1.5rem; margin-top: 2rem;">
          <p style="color: var(--text-primary); font-size: 0.9rem; margin: 0;">
            <strong>üí° Nota:</strong> Las salas utilizan tecnolog√≠a Jitsi Meet (gratuita y segura). No necesitas instalar nada, funciona directo desde el navegador.
          </p>
        </div>
      </div>

    </main>
  </div>

  <!-- Profile Modal -->
  <div id="profile-modal" class="modal-overlay hidden" onclick="closeModal(event, 'profile-modal')">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3>Mi Perfil</h3>
        <button class="modal-close" onclick="hideProfileModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="profile-form">
          <div class="form-group">
            <label>DNI</label>
            <input type="text" id="profile-dni" disabled>
          </div>
          <div class="form-group">
            <label for="profile-email">Email</label>
            <input type="email" id="profile-email" placeholder="tu@email.com">
          </div>
          <div class="form-group">
            <label for="profile-phone">Tel√©fono</label>
            <input type="tel" id="profile-phone" placeholder="+54 11 1234-5678">
          </div>
        </form>

        <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid var(--border);">

        <h4 style="margin-bottom: 1rem;">Cambiar Contrase√±a</h4>
        <form id="password-form">
          <div class="form-group">
            <label for="current-password">Contrase√±a Actual</label>
            <input type="password" id="current-password">
          </div>
          <div class="form-group">
            <label for="new-password">Nueva Contrase√±a</label>
            <input type="password" id="new-password">
          </div>
          <button type="submit" class="btn btn-secondary" style="width: 100%;">Cambiar Contrase√±a</button>
        </form>

        <div id="profile-message" class="hidden" style="margin-top: 1rem;"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="hideProfileModal()">Cancelar</button>
        <button class="btn btn-primary" onclick="saveProfile()">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Comments Modal -->
  <div id="comments-modal" class="modal-overlay hidden" onclick="closeModal(event, 'comments-modal')">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3>Comentarios</h3>
        <button class="modal-close" onclick="hideCommentsModal()">&times;</button>
      </div>
      <div class="modal-body" id="comments-modal-content">
        <div class="loading">Cargando comentarios...</div>
      </div>
    </div>
  </div>

  <!-- Daily Mood Check-in Modal -->
  <div id="mood-checkin-modal" class="modal-overlay hidden" onclick="event.stopPropagation()">
    <div class="modal" onclick="event.stopPropagation()" style="max-width: 480px;">
      <div class="modal-header">
        <h3>Evaluaci√≥n de Estado Actual</h3>
        <button class="modal-close" onclick="skipMoodCheckin()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="mood-checkin-container">
          
          <p class="mood-question" style="font-size: 0.95rem; color: var(--text-muted); margin-bottom: 1.5rem;">Seleccion√° la opci√≥n que mejor describe tu estado actual:</p>

          <!-- Escala Visual Anal√≥gica (VAS) profesional -->
          <div class="mood-scale-container" style="margin-bottom: 2rem;">
            <div class="mood-scale-labels" style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.75rem; color: var(--text-muted);">
              <span>Muy mal</span>
              <span>Excelente</span>
            </div>
            <div class="mood-scale" style="position: relative; height: 60px; background: linear-gradient(90deg, #ef4444 0%, #f59e0b 25%, #eab308 50%, #84cc16 75%, #22c55e 100%); border-radius: 30px; cursor: pointer;" onclick="selectMoodFromScale(event)">
              <div id="mood-indicator" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: white; border: 3px solid var(--primary); border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.2); pointer-events: none; transition: all 0.3s;"></div>
            </div>
            <div id="mood-value-display" style="text-align: center; margin-top: 0.75rem; font-weight: 600; color: var(--text); display: none;">
              Estado: <span id="mood-value-text">Regular</span>
            </div>
          </div>

          <!-- Opciones discretas alternativas -->
          <div class="mood-options-discrete" id="mood-options" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.5rem; margin-bottom: 1.5rem;">
            <button type="button" class="mood-btn" data-value="1" onclick="selectMood(1)" style="padding: 0.75rem 0.5rem; border: 2px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.2s; font-size: 0.75rem; text-align: center;">
              <div style="font-weight: 600; color: #dc2626; margin-bottom: 0.25rem;">1</div>
              <div style="color: var(--text-muted);">Muy mal</div>
            </button>
            <button type="button" class="mood-btn" data-value="2" onclick="selectMood(2)" style="padding: 0.75rem 0.5rem; border: 2px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.2s; font-size: 0.75rem; text-align: center;">
              <div style="font-weight: 600; color: #f59e0b; margin-bottom: 0.25rem;">2</div>
              <div style="color: var(--text-muted);">Mal</div>
            </button>
            <button type="button" class="mood-btn" data-value="3" onclick="selectMood(3)" style="padding: 0.75rem 0.5rem; border: 2px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.2s; font-size: 0.75rem; text-align: center;">
              <div style="font-weight: 600; color: #eab308; margin-bottom: 0.25rem;">3</div>
              <div style="color: var(--text-muted);">Regular</div>
            </button>
            <button type="button" class="mood-btn" data-value="4" onclick="selectMood(4)" style="padding: 0.75rem 0.5rem; border: 2px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.2s; font-size: 0.75rem; text-align: center;">
              <div style="font-weight: 600; color: #84cc16; margin-bottom: 0.25rem;">4</div>
              <div style="color: var(--text-muted);">Bien</div>
            </button>
            <button type="button" class="mood-btn" data-value="5" onclick="selectMood(5)" style="padding: 0.75rem 0.5rem; border: 2px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.2s; font-size: 0.75rem; text-align: center;">
              <div style="font-weight: 600; color: #22c55e; margin-bottom: 0.25rem;">5</div>
              <div style="color: var(--text-muted);">Muy bien</div>
            </button>
          </div>

          <!-- Selector de Color Profesional -->
          <div class="color-palette-section" style="margin-top: 1.5rem;">
            <p style="font-weight: 600; margin-bottom: 0.75rem; font-size: 0.9rem; color: var(--text);">Asociaci√≥n crom√°tica (opcional):</p>

            <!-- Paleta de colores cl√≠nicos -->
            <div id="color-palette-grid" style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-bottom: 1rem;">
              <!-- Rojos/Naranjas -->
              <button type="button" class="color-swatch" onclick="selectColor('#dc2626')" style="width: 100%; aspect-ratio: 1; background: #dc2626; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#ea580c')" style="width: 100%; aspect-ratio: 1; background: #ea580c; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#f59e0b')" style="width: 100%; aspect-ratio: 1; background: #f59e0b; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <!-- Amarillos -->
              <button type="button" class="color-swatch" onclick="selectColor('#eab308')" style="width: 100%; aspect-ratio: 1; background: #eab308; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#84cc16')" style="width: 100%; aspect-ratio: 1; background: #84cc16; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <!-- Verdes -->
              <button type="button" class="color-swatch" onclick="selectColor('#22c55e')" style="width: 100%; aspect-ratio: 1; background: #22c55e; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              
              <!-- Azules/Cielos -->
              <button type="button" class="color-swatch" onclick="selectColor('#06b6d4')" style="width: 100%; aspect-ratio: 1; background: #06b6d4; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#3b82f6')" style="width: 100%; aspect-ratio: 1; background: #3b82f6; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#6366f1')" style="width: 100%; aspect-ratio: 1; background: #6366f1; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <!-- Violetas/Rosas -->
              <button type="button" class="color-swatch" onclick="selectColor('#8b5cf6')" style="width: 100%; aspect-ratio: 1; background: #8b5cf6; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <button type="button" class="color-swatch" onclick="selectColor('#ec4899')" style="width: 100%; aspect-ratio: 1; background: #ec4899; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
              <!-- Neutrales -->
              <button type="button" class="color-swatch" onclick="selectColor('#64748b')" style="width: 100%; aspect-ratio: 1; background: #64748b; border: 2px solid transparent; border-radius: 6px; cursor: pointer; transition: all 0.2s;"></button>
            </div>

            <div id="selected-color-preview" style="display: none; padding: 0.5rem; border-radius: 6px; text-align: center; font-size: 0.85rem; font-weight: 500; color: white; margin-top: 0.5rem;">
              Color seleccionado
            </div>
          </div>

          <div class="mood-note-section" style="margin-top: 1.5rem;">
            <label for="mood-note" style="display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem;">Observaciones (opcional):</label>
            <textarea id="mood-note" placeholder="Calidad de sue√±o, s√≠ntomas, factores relevantes..." style="width: 100%; min-height: 80px; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; font-size: 0.9rem; resize: vertical;"></textarea>
          </div>

          <span class="mood-skip" onclick="skipMoodCheckin()" style="display: block; text-align: center; margin-top: 1rem; color: var(--text-muted); font-size: 0.85rem; cursor: pointer; text-decoration: underline;">Omitir evaluaci√≥n</span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="submit-mood-btn" onclick="submitMoodCheckin()" disabled style="width: 100%;">Guardar Evaluaci√≥n</button>
      </div>
    </div>
  </div>

  <script src="/js/hdd-portal.js" defer></script>
</body>
</html>
